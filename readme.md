# stable diffusion webapi

API Client for the [stable-diffusion-webui](https://github.com/AUTOMATIC1111/stable-diffusion-webui)

stable-diffusion-webui use fastapi to generate API, it follow the [openapi](https://swagger.io/specification/) specification, so we can use [openapi-generator](https://github.com/OpenAPITools/openapi-generator) to generate the api client for us. here is Typescript api client for stable-diffusion-webui with type hint and auto complete for good development experience. you don't need to send http request manually, just use the api client.

## install

```bash
npm install stable-diffusion-webapi
```

### usage

```typescript
import { Configuration, DefaultApi } from "stable-diffusion-webapi";

// get the api instance
const configuration = new Configuration({
  basePath: "http://localhost:7861", // change this to your server address
});

const api = new DefaultApi(configuration);

// text2image
api.text2imgapiSdapiV1Txt2imgPost({
  prompt: "a cat flying in the sky",
});

// get current progress
api.progressapiSdapiV1ProgressGet();
```

the api client method name is generated by the openapi-generator, it's not very friendly, but it's ok for now.

for example, the `text2imgapiSdapiV1Txt2imgPost` method is generated from the openapi.json use `operationId` field.

```json
{
  "/sdapi/v1/txt2img": {
    "post": {
      "summary": "Text2Imgapi",
      "operationId": "text2imgapi_sdapi_v1_txt2img_post",
      "requestBody": {},
      "responses": {}
    }
  }
}
```

## how it works

1. run stable-diffusion-webui with `nowebui` mode.

2. visit http://127.0.0.1:7861/openapi.json to check the openapi.json is ok.

3. generate api client with openapi-generator

```bash
# openapi-generator-cli generate -i http://127.0.0.1:7861/openapi.json -g python -o python -c config.py.json
openapi-generator-cli generate -i http://127.0.0.1:7861/openapi.json -g typescript-axios -o src -c config.ts.json
```

you can run the stable-diffusion-webui in `nowebui` mode and use the API client to access the API and build your own application.

## Thanks

- [openapi-generator](https://github.com/OpenAPITools/openapi-generator)
- [stable-diffusion-webui](https://github.com/AUTOMATIC1111/stable-diffusion-webui)
